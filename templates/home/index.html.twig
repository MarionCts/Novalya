{% extends 'base.html.twig' %}

{% block title %}Novalya |
	{{ 'homePage.pageTitle'|trans }}
{% endblock %}

{% block body %}

	<main
		class="homepage">

		{# HERO IMAGE SECTION #}
		<section class="hero">
			<div class="hero__bg"></div>
			<div class="hero__content">
				<h1 class="title title__primary center">{{ 'homePage.mainTitle'|trans }}
					<span class="title title__primary line-jump center">{{ 'homePage.mainAccent'|trans }}</span>
				</h1>
				<p class="center">{{ 'homePage.description'|trans }}</p>
				<a href="{{ path('app_property_filter') }}" class="button__primary">{{ 'homePage.button'|trans }}</a>
			</div>
		</section>

		{# INTRO SECTION #}
		<section class="intro p-section">
			<div class="intro__image brr-60">
				<img src="{{ asset('images/intro_villa.webp') }}" alt="{{ 'homePage.alt.intro'|trans }}">
			</div>
			<div class="intro__content">
				<h2 class="title title__secondary mb-55">{{ 'homePage.intro.mainTitle'|trans }}
					<span class="title title__secondary accent">{{ 'homePage.intro.mainAccent'|trans }}</span>
				</h2>
				<p class="paragraph">{{ 'homePage.intro.firstP'|trans }}</p>
				<br>
				<p class="paragraph">{{ 'homePage.intro.secondP'|trans }}</p>
			</div>
		</section>

		{# LAST PROPERTIES CAROUSEL SECTION #}

		{% if properties %}
			<section class="home__properties">
				<h2 class="title title__secondary mb-55">{{ 'homePage.properties.mainTitle'|trans }}
					<span class="title title__secondary accent">{{ 'homePage.properties.mainAccent'|trans }}</span>
				</h2>

				<div
					class="cards">
					{# If there is no property set to favorite yet, "favoriteIds" will
					display an empty array #}
					{% set favoriteIds = favoriteIds|default([]) %}

					{% for property in properties %}

						{# we set the parameters of "isFavorited" which will fetch wether 
						the property has been set to favorite or not #}
						{% set isFavorited = app.user and (property.id in favoriteIds) %}

						{% if property.status.value == "Published" %}
							<div class="card__container">
								<div class="card__image">
									{% for image in property.propertyImages %}
										{# Selects only the featured image among all the pictures related to this property #}
										{% if image.property.id == property.id and image.isFeatured == true %}
											<img src="{{ asset(image.url) }}" alt="{{ 'homePage.alt.card'|trans }}">
										{% endif %}
									{% endfor %}
								</div>
								<div class="card__content">

									<form method="post" class="favorite-form" action="{{ path('app_favorite_new', {'property': property.id}) }}" data-id="{{ property.id }}">
										<input type="hidden" name="_token" value="{{ csrf_token('favoriteBtn' ~ property.id) }}">

										<button
											type="submit" class="button__favorite">

											{# If the property is not yet a user's favorite, 
											we display the empty heart icon thanks to the 
											"favorite-toggle" CSS class, otherwise we hide it  #}
											<svg id="favorite-none-{{ property.id }}" class="favorite-none {{ isFavorited ? '' : 'favorite-toggle' }}" viewbox="0 0 30 27" aria-hidden="true" focusable="false">
												<path fill-rule="evenodd" clip-rule="evenodd" d="M21.696,0.85l0.001,-0.15l0.147,-0l0.001,0.003l0.003,0.001c4.122,0.081 7.452,3.44 7.452,7.562c0,3.587 -1.76,6.376 -4.356,9.098c-1.285,1.349 -2.78,2.687 -4.371,4.104c-1.586,1.412 -3.269,2.904 -4.942,4.57c-0.351,0.349 -0.92,0.349 -1.27,-0c-2.068,-2.059 -4.15,-3.853 -6.045,-5.558c-1.902,-1.711 -3.617,-3.335 -4.928,-5.035c-1.83,-2.374 -2.688,-4.659 -2.688,-7.179c-0,-4.173 3.408,-7.566 7.597,-7.566c1.757,-0 3.11,0.425 4.223,1.206c0.982,0.689 1.767,1.651 2.476,2.826c0.709,-1.175 1.494,-2.137 2.476,-2.826c1.113,-0.781 2.466,-1.206 4.223,-1.206l0,0.15l0.001,-0Zm-0.001,1.642c-1.366,-0 -2.407,0.278 -3.313,0.965c-0.923,0.7 -1.723,1.829 -2.583,3.542c-0.331,0.659 -1.275,0.658 -1.606,-0c-0.86,-1.713 -1.66,-2.842 -2.582,-3.542c-0.907,-0.687 -1.948,-0.965 -3.314,-0.965c-3.199,0 -5.8,2.59 -5.8,5.774c-0,3.014 1.529,5.426 3.876,7.886c1.186,1.243 2.575,2.491 4.077,3.83c1.442,1.284 2.985,2.65 4.546,4.165c1.563,-1.517 3.108,-2.884 4.551,-4.169c1.503,-1.339 2.894,-2.587 4.08,-3.83c2.348,-2.459 3.876,-4.869 3.876,-7.882c0,-3.183 -2.605,-5.774 -5.808,-5.774Z"/>
											</svg>
											{# If the property is already a user's favorite, 
											we display the full heart icon thanks to the 
											"favorite-toggle" CSS class, otherwise we hide it  #}
											<svg id="favorite-done-{{ property.id }}" class="favorite-done {{ isFavorited ? 'favorite-toggle' : '' }}" viewbox="0 0 30 27" aria-hidden="true" focusable="false">
												<path fill-rule="evenodd" clip-rule="evenodd" d="M21.696,0.85l0.001,-0.15l0.147,-0l0.001,0.003l0.003,0.001c4.122,0.081 7.452,3.44 7.452,7.562c0,3.587 -1.76,6.376 -4.356,9.098c-1.285,1.349 -2.78,2.687 -4.371,4.104c-1.586,1.412 -3.269,2.904 -4.942,4.57c-0.351,0.349 -0.92,0.349 -1.27,-0c-2.068,-2.059 -4.15,-3.853 -6.045,-5.558c-1.902,-1.711 -3.617,-3.335 -4.928,-5.035c-1.83,-2.374 -2.688,-4.659 -2.688,-7.179c-0,-4.173 3.408,-7.566 7.597,-7.566c1.757,-0 3.11,0.425 4.223,1.206c0.982,0.689 1.767,1.651 2.476,2.826c0.709,-1.175 1.494,-2.137 2.476,-2.826c1.113,-0.781 2.466,-1.206 4.223,-1.206l0,0.15l0.001,-0Z"/>
											</svg>
										</button>
									</form>

									<div class="card__content--text">
										<h4 class="title title__tertiary">{{ property.name }}</h4>
										<div class="text__specs">
											<p class="paragraph__small">{{ property.city }}</p>
											<p class="paragraph__small">{{ property.bedroomNumber }}
												{{ 'homePage.services.bedrooms'|trans }}
												|
												{{ property.indoorSurface }}
												mÂ²</p>
										</div>
										<div class="text__price">
											<p class="card__price">{{ property.price|format_currency('EUR', {fraction_digit: 0}) }}</p>
											<a href="{{ path('app_property_show', {'id': property.id}) }}" class="button button__property">
												<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 18 16" aria-hidden="true" focusable="false">
													<path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M1,7h13.586L9.929,2.343c-.391-.39-.391-1.024,0-1.414.39-.391 1.024-.391 1.414,0l6.364,6.364c.391.39.391 1.024 0 1.414l-6.364,6.364c-.39.391-1.024.391-1.414,0-.391-.391-.391-1.024 0-1.414l4.657-4.657H1c-.552 0-1-.448-1-1s.448-1 1-1Z"/>
												</svg>
											</a>
										</div>
									</div>
								</div>
							</div>
						{% endif %}
					{% endfor %}
				</div>

				<a href="{{ path('app_property_filter') }}" class="button button__primary">{{ 'homePage.properties.button'|trans }}</a>

			</section>
		{% endif %}

		{# SERVICES SECTION #}
		<section class="services p-section">
			<h2 class="title title__secondary center">{{ 'homePage.services.mainTitle'|trans }}
				<span class="title title__secondary accent line-jump">{{ 'homePage.services.mainAccent'|trans }}</span>
			</h2>
			<p class="section__intro mb-55">{{ 'homePage.services.description'|trans }}</p>

			<div
				class="services__container">

				{# FIRST SERVICE CARD #}
				<div class="services__card">
					<div class="services__card--verso">
						<h4 class="title title__fourth">{{ 'homePage.services.firstSecondTitle'|trans }}
							<span class="title title__fourth accent line-jump">{{ 'homePage.services.firstSecondAccent'|trans }}</span>
						</h4>
						<p class="paragraph__xsmall">{{ 'homePage.services.firstdescription'|trans }}</p>
					</div>
					<div class="services__card--recto">
						<h3 class="title title__tertiary">{{ 'homePage.services.firstMainTitle'|trans }}
							<span class="title title__tertiary accent line-jump">{{ 'homePage.services.firstMainAccent'|trans }}</span>
						</h3>
						<span class="accent__number">01</span>
					</div>
				</div>

				{# SECOND SERVICE CARD #}
				<div class="services__card">
					<div class="services__card--verso">
						<h4 class="title title__fourth">{{ 'homePage.services.secondSecondTitle'|trans }}
							<span class="title title__fourth accent line-jump">{{ 'homePage.services.secondSecondAccent'|trans }}</span>
						</h4>
						<p class="paragraph__xsmall">{{ 'homePage.services.seconddescription'|trans }}</p>
					</div>
					<div class="services__card--recto">
						<h3 class="title title__tertiary">{{ 'homePage.services.secondMainTitle'|trans }}
							<span class="title title__tertiary accent line-jump">{{ 'homePage.services.secondMainAccent'|trans }}</span>
						</h3>
						<span class="accent__number">02</span>
					</div>
				</div>

				{# THIRD SERVICE CARD #}
				<div class="services__card">
					<div class="services__card--verso">
						<h4 class="title title__fourth">{{ 'homePage.services.thirdSecondTitle'|trans }}
							<span class="title title__fourth accent line-jump">{{ 'homePage.services.thirdSecondAccent'|trans }}</span>
						</h4>
						<p class="paragraph__xsmall">{{ 'homePage.services.thirddescription'|trans }}</p>
					</div>
					<div class="services__card--recto">
						<h3 class="title title__tertiary">{{ 'homePage.services.thirdMainTitle'|trans }}
							<span class="title title__tertiary accent line-jump">{{ 'homePage.services.thirdMainAccent'|trans }}</span>
						</h3>
						<span class="accent__number">03</span>
					</div>
				</div>

				{# FOURTH SERVICE CARD #}
				<div class="services__card">
					<div class="services__card--verso">
						<h4 class="title title__fourth">{{ 'homePage.services.fourthSecondTitle'|trans }}
							<span class="title title__fourth accent line-jump">{{ 'homePage.services.fourthSecondAccent'|trans }}</span>
						</h4>
						<p class="paragraph__xsmall">{{ 'homePage.services.fourthdescription'|trans }}</p>
					</div>
					<div class="services__card--recto">
						<h3 class="title title__tertiary">{{ 'homePage.services.fourthMainTitle'|trans }}
							<span class="title title__tertiary accent line-jump">{{ 'homePage.services.fourthMainAccent'|trans }}</span>
						</h3>
						<span class="accent__number">04</span>
					</div>
				</div>
			</div>
			<a href="{{ path('app_contact_index') }}" class="button button__primary mt-35">{{ 'contactBtn'|trans }}</a>
		</section>
	</main>

	{# FOOTER #}
	{% block footer %}
		{% include 'layout/footer.html.twig' %}
	{% endblock %}
{% endblock %}
